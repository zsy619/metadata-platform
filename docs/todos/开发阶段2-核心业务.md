# 开发阶段2：核心业务

> **项目**: 元数据管理平台  
> **技术栈**: 
> - 前端: Vue3 + TypeScript + Element Plus + Vite  
> - 后端: Golang + Hertz + GORM + MySQL/PostgreSQL  
> **最后更新**: 2026-01-24

---

## 前端开发任务

### 数据源管理
- [ ] 数据源列表页（views/datasource/List.vue）
  - [ ] 列表展示（表格）
  - [ ] 分页
  - [ ] 搜索（关键字）
  - [ ] 筛选（类型）
  - [ ] 操作按钮（新建/编辑/删除/测试连接）
  - [ ] 连接状态显示
  - [ ] 批量操作
- [ ] 数据源表单对话框（components/DataSourceForm.vue）
  - [ ] 表单字段（名称/类型/主机/端口/用户名/密码/数据库）
  - [ ] 表单验证（必填/格式）
  - [ ] 连接测试按钮
  - [ ] 测试成功自动填充
  - [ ] 密码显示/隐藏
  - [ ] 保存/取消
- [ ] 数据库对象浏览器（components/ObjectBrowser.vue）
  - [ ] 树形结构（数据源/Schema/表/视图）
  - [ ] 懒加载
  - [ ] 搜索功能
  - [ ] 刷新功能
  - [ ] 右键菜单（预览/构建模型）
- [ ] 数据预览对话框（components/DataPreview.vue）
  - [ ] 表格展示
  - [ ] 分页
  - [ ] 列信息显示

### 模型管理⭐⭐⭐
- [ ] 模型列表页（views/model/List.vue）
  - [ ] 列表展示
  - [ ] 分页+搜索
  - [ ] 筛选（按数据源/类型/状态）
  - [ ] 操作（新建/从表构建/编辑/删除/克隆）
  - [ ] 模型状态显示（锁定/公开）
  - [ ] 批量操作
- [ ] 模型构建向导（components/BuildWizard.vue）
  - [ ] 步骤器（6步）
  - [ ] 向导流程控制
  - [ ] 数据验证
  - [ ] 进度保存（可选）
- [ ] 步骤1：数据源选择器（components/DataSourceSelector.vue）
  - [ ] 数据源列表
  - [ ] 连接状态显示
  - [ ] 测试连接
- [ ] 步骤2：表/视图选择器（components/TableViewSelector.vue）
  - [ ] 标签页切换（表/视图）
  - [ ] 表列表展示
  - [ ] 搜索功能
  - [ ] 预览表结构按钮
  - [ ] 预览表数据按钮
  - [ ] 记录数显示
- [ ] 步骤3：字段配置器（components/FieldConfigurator.vue）
  - [ ] 字段列表表格
  - [ ] 全选/全不选
  - [ ] 字段选择（checkbox）
  - [ ] 字段属性编辑（显示名称/字段代码/数据类型/长度/必填/主键/默认值）
  - [ ] 添加自定义字段
  - [ ] 删除自定义字段
  - [ ] 字段拖拽排序
- [ ] 步骤4：验证规则配置器（components/ValidationConfigurator.vue）
  - [ ] 为每个字段配置验证规则
  - [ ] 验证类型选择（必填/长度/范围/格式/自定义）
  - [ ] 验证规则模板（邮箱/手机号/身份证/URL）
  - [ ] 错误提示信息配置
  - [ ] 验证规则测试
- [ ] 步骤5：显示配置器（components/DisplayConfigurator.vue）
  - [ ] 显示名称配置
  - [ ] 显示顺序调整（拖拽）
  - [ ] 显示宽度配置
  - [ ] 组件类型选择（input/select/textarea/date-picker/upload等）
  - [ ] 组件选项配置（下拉选项/上传限制等）
  - [ ] 占位符/帮助文本
  - [ ] 可搜索/可排序/可筛选配置
- [ ] 步骤6：配置预览（components/BuildPreview.vue）
  - [ ] 模型信息摘要
  - [ ] 字段列表预览
  - [ ] 验证规则预览
  - [ ] 显示配置预览
  - [ ] 确认创建按钮

### 接口管理
- [ ] 接口列表页（views/api/List.vue）
  - [ ] 列表展示
  - [ ] 筛选（按模型/方法/状态）
  - [ ] 操作（批量生成/新建/编辑/删除/测试）
  - [ ] 启用/禁用开关
  - [ ] 接口路径显示
  - [ ] 请求方法标签（GET/POST/PUT/DELETE）
- [ ] 批量生成对话框（components/BatchGenerateDialog.vue）
  - [ ] 模型选择（下拉+搜索）
  - [ ] 接口类型选择（Create/Read/Update/Delete/List）
  - [ ] 路径前缀配置
  - [ ] 接口预览列表
  - [ ] 冲突检测提示
  - [ ] 确认生成
- [ ] 接口编辑页面（views/api/Editor.vue）
  - [ ] 基本信息（名称/编码/路径/方法/关联模型/描述）
  - [ ] 路径参数配置
  - [ ] 查询参数配置
  - [ ] 请求体配置
  - [ ] 响应配置
  - [ ] 保存/取消
- [ ] 接口测试工具（components/APITester.vue）
  - [ ] 请求构造器（自动填充参数）
  - [ ] 参数输入（路径/查询/body）
  - [ ] 发送请求按钮
  - [ ] 请求信息显示（URL/Method/Headers/Body）
  - [ ] 响应展示（JSON格式化+状态码+响应时间）
  - [ ] 历史记录（保存+快速复用）
  - [ ] 错误提示

### 查询模板管理⭐⭐
- [ ] 查询模板列表（在模型详情页添加标签）
  - [ ] 模板列表展示
  - [ ] 默认模板标识
  - [ ] 操作（新建/编辑/删除/设为默认/复制/预览）
- [ ] 可视化条件构建器（components/QueryBuilder.vue）
  - [ ] 条件行组件
  - [ ] 字段选择下拉（显示字段类型）
  - [ ] 操作符选择（根据字段类型显示可用操作符）
  - [ ] 值输入组件
    - [ ] 文本输入
    - [ ] 数字输入
    - [ ] 日期选择器
    - [ ] 下拉选择
    - [ ] 多选输入（用于IN）
    - [ ] 范围输入（用于BETWEEN）
  - [ ] 逻辑运算符选择（AND/OR）
  - [ ] 添加条件按钮
  - [ ] 删除条件按钮
  - [ ] 条件组支持（括号）
  - [ ] 添加条件组
  - [ ] 嵌套条件支持
- [ ] SQL预览组件（components/SQLPreview.vue）
  - [ ] 显示生成的SQL
  - [ ] 语法高亮
  - [ ] 复制按钮
  - [ ] 格式化按钮
- [ ] 查询模板编辑器（views/query-template/Editor.vue）
  - [ ] 模板基本信息（名称/编码/描述）
  - [ ] 集成条件构建器
  - [ ] 条件配置
  - [ ] SQL预览
  - [ ] 结果预览（执行查询+表格展示）
  - [ ] 保存/测试/取消

### 数据查询界面
- [ ] 数据列表页（views/data/List.vue）
  - [ ] 动态表格（根据模型字段生成列）
  - [ ] 高级筛选器
    - [ ] 快速筛选（常用字段）
    - [ ] 自定义筛选（调用条件构建器）
    - [ ] 模板筛选（应用查询模板）
    - [ ] 筛选保存为模板
  - [ ] 字段选择器（勾选显示字段+调整顺序+固定列）
  - [ ] 分页
  - [ ] 排序
  - [ ] 操作列（查看/编辑/删除）
  - [ ] 批量操作
  - [ ] 导出按钮
- [ ] 数据详情页（views/data/Detail.vue）
  - [ ] 字段值展示
  - [ ] 格式化显示
  - [ ] 编辑按钮
  - [ ] 返回列表
- [ ] 数据表单对话框（components/DataForm.vue）
  - [ ] 动态表单（根据模型字段配置生成）
  - [ ] 组件类型渲染（input/select/date-picker等）
  - [ ] 表单验证（应用验证规则）
  - [ ] 默认值填充
  - [ ] 必填标识
  - [ ] 帮助文本显示
  - [ ] 保存/取消

---

## 后端开发任务

### SQL生成引擎⭐⭐⭐
- [ ] SQLBuilder架构
  - [ ] 创建SQLBuilder主类
  - [ ] 定义ModelData结构体（聚合所有模型数据）
  - [ ] loadModelData方法（加载模型+表+字段+JOIN+WHERE+GROUP等）
- [ ] SELECT子句构建器
  - [ ] buildSelectClause方法
  - [ ] buildFieldExpression方法（字段+表名前缀）
  - [ ] 支持字段函数（UPPER/LOWER/DATE_FORMAT/SUBSTRING等）
  - [ ] 支持聚合函数（SUM/COUNT/AVG/MAX/MIN）
  - [ ] 支持字段别名（show_title）
- [ ] FROM子句构建器
  - [ ] buildFromClause方法
  - [ ] 识别主表（is_main标记）
  - [ ] 支持schema.table格式
- [ ] JOIN子句构建器
  - [ ] buildJoinClause方法
  - [ ] buildJoinTree方法（支持嵌套JOIN，parent_id树形结构）
  - [ ] generateJoinSQL方法（递归生成）
  - [ ] buildJoinConditions方法（ON条件+括号+AND/OR）
  - [ ] 支持LEFT/RIGHT/INNER/FULL OUTER JOIN
  - [ ] 支持字段与字段比较
  - [ ] 支持字段与值比较
  - [ ] 支持JOIN字段函数
- [ ] WHERE子句构建器
  - [ ] buildWhereClause方法
  - [ ] buildSingleCondition方法
  - [ ] 支持所有运算符（=/!=/>/</>=/<=/LIKE/IN/BETWEEN/IS NULL/IS NOT NULL）
  - [ ] 支持复杂条件（括号+AND/OR组合）
  - [ ] 支持字段与字段比较
  - [ ] 支持字段与值比较
  - [ ] 参数化查询（防SQL注入）
  - [ ] 支持字段函数
  - [ ] 支持动态参数替换
- [ ] GROUP BY和HAVING子句构建器
  - [ ] buildGroupByClause方法
  - [ ] buildHavingClause方法
  - [ ] 支持分组字段函数
  - [ ] 支持HAVING聚合条件（类似WHERE逻辑）
- [ ] ORDER BY和LIMIT子句构建器
  - [ ] buildOrderByClause方法（多字段+ASC/DESC）
  - [ ] buildLimitClause方法（LIMIT+OFFSET）
  - [ ] 支持动态分页参数
- [ ] SQL组装与执行
  - [ ] buildFromMetadata方法（组装完整SQL）
  - [ ] buildFromSQL方法（处理原始SQL类型）
  - [ ] SQL语法验证
  - [ ] SQL注入检测

### SQL执行器
- [ ] SQLExecutor类
  - [ ] Execute方法（执行模型查询+动态参数）
  - [ ] ExecuteCount方法（统计总数）
  - [ ] parseRows方法（结果解析为map切片）
  - [ ] SQL日志记录
  - [ ] 执行时间监控
  - [ ] 慢查询告警
- [ ] 数据源连接管理
  - [ ] GetConnection方法（根据conn_id获取连接）
  - [ ] 连接池复用
  - [ ] 连接健康检查

### 字段增强配置
- [ ] FieldEnhancement Model（需新建表md_model_field_enhancements）
  - [ ] display_name（显示名称）
  - [ ] display_order（显示顺序）
  - [ ] display_width（显示宽度）
  - [ ] is_searchable/is_sortable/is_filterable（查询配置）
  - [ ] placeholder/help_text（提示信息）
  - [ ] component_type（组件类型：input/select/date-picker等）
  - [ ] component_config（JSON组件配置：选项/限制等）
- [ ] FieldEnhancement Service
  - [ ] UpdateEnhancements方法（单个更新）
  - [ ] BatchUpdateEnhancements方法（批量更新）
  - [ ] GetEnhancements方法（按模型ID查询）
- [ ] FieldEnhancement API
  - [ ] GET /api/models/{id}/fields/enhancements
  - [ ] PUT /api/models/{id}/fields/enhancements
  - [ ] POST /api/models/{id}/fields/batch-enhancements

### CRUD接口自动生成
- [ ] API Model（基于现有表）
- [ ] APIParam Model
- [ ] API Generator Service
  - [ ] BatchGenerate方法（批量生成CRUD接口配置）
  - [ ] 生成Create/Read/Update/Delete/List接口
  - [ ] 生成接口路径（/api/data/{model_code}）
  - [ ] 生成参数配置
  - [ ] 路径冲突检测
- [ ] Dynamic Router
  - [ ] RegisterAPI方法（动态注册路由）
  - [ ] handleCreate/handleGet/handleUpdate/handleDelete/handleList
  - [ ] 路由参数绑定
  - [ ] 请求验证
- [ ] CRUD Service
  - [ ] Create方法（验证+默认值+插入+返回ID）
  - [ ] Get方法（按ID查询）
  - [ ] Update方法（验证+更新）
  - [ ] Delete方法（软删除）
  - [ ] List方法（分页+排序+筛选+应用查询模板）
  - [ ] BatchCreate/BatchUpdate/BatchDelete
  - [ ] 数据验证器（基于字段配置）
  - [ ] 默认值应用
- [ ] API Management API
  - [ ] GET /api/apis（接口列表）
  - [ ] POST /api/apis/batch-generate（批量生成）
  - [ ] PUT /api/apis/{id}（更新配置）
  - [ ] DELETE /api/apis/{id}（删除）
  - [ ] POST /api/apis/{id}/enable（启用/禁用）
  - [ ] POST /api/apis/{id}/test（测试接口）

### 查询模板管理
- [ ] QueryTemplate Model（基于md_model相关表）
- [ ] QueryCondition Model
- [ ] QueryTemplate Service
  - [ ] Create/Get/Update/Delete方法
  - [ ] SetDefault方法（设置默认模板）
  - [ ] ApplyTemplate方法（应用模板到查询）
  - [ ] Duplicate方法（复制模板）
- [ ] QueryTemplate API
  - [ ] GET /api/models/{id}/query-templates
  - [ ] POST /api/models/{id}/query-templates
  - [ ] GET /api/query-templates/{id}
  - [ ] PUT /api/query-templates/{id}
  - [ ] DELETE /api/query-templates/{id}
  - [ ] POST /api/query-templates/{id}/set-default
  - [ ] POST /api/query-templates/{id}/duplicate
  - [ ] GET /api/query-templates/{id}/preview（预览SQL+结果）

### 数据查询API
- [ ] POST /api/data/{model}/query（通用查询接口）
- [ ] GET /api/data/{model}（列表查询+查询模板）
- [ ] GET /api/data/{model}/{id}（详情查询）
- [ ] POST /api/data/{model}（创建数据）
- [ ] PUT /api/data/{model}/{id}（更新数据）
- [ ] DELETE /api/data/{model}/{id}（删除数据）
- [ ] POST /api/data/{model}/batch-create（批量创建）
- [ ] PUT /api/data/{model}/batch-update（批量更新）
- [ ] DELETE /api/data/{model}/batch-delete（批量删除）
- [ ] GET /api/data/{model}/statistics（数据统计）
- [ ] POST /api/data/{model}/aggregate（聚合查询）

---

## 验收标准

### 前端验收
- 模型构建向导流程完整
- 接口管理功能可用
- 查询模板编辑器易用
- 数据查询界面功能完整

### 后端验收
- SQL生成引擎可生成复杂SQL
- 可批量生成CRUD接口
- 动态路由正常工作
- 查询模板功能完整

### 集成验收
- 模型构建功能正常
- 接口生成和调用正常
- 查询模板应用正常
- 数据查询功能完整